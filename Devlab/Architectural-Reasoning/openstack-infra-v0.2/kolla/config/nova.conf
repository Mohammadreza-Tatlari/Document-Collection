# Nova Compute Service Configuration Overrides
# These settings will be merged with Kolla-Ansible defaults
# Reference: https://docs.openstack.org/nova/latest/configuration/

[DEFAULT]
# Logging
debug = false
verbose = false
log_dir = /var/log/nova

# Compute Driver
compute_driver = libvirt.LibvirtDriver

# Live Migration
live_migration_permit_auto_converge = true
live_migration_permit_post_copy = true
live_migration_timeout = 600

# CPU Configuration
cpu_allocation_ratio = 16.0
ram_allocation_ratio = 1.5
disk_allocation_ratio = 1.0

# Image Caching
remove_unused_base_images = true
remove_unused_original_minimum_age_seconds = 86400

# Instance Configuration
default_ephemeral_format = ext4
force_raw_images = false

[libvirt]
# Libvirt Configuration
virt_type = qemu  # Change to 'kvm' if hardware virtualization available
cpu_mode = host-passthrough
disk_cachemodes = network=writeback
inject_password = false
inject_key = false
inject_partition = -2

# RBD Backend for Instance Storage
images_type = rbd
images_rbd_pool = vms
images_rbd_ceph_conf = /etc/ceph/ceph.conf
rbd_user = nova
rbd_secret_uuid = {{ cinder_rbd_secret_uuid }}

# Live Migration
live_migration_uri = qemu+ssh://%s/system
live_migration_scheme = ssh

[oslo_concurrency]
lock_path = /var/lib/nova/tmp

[oslo_messaging_notifications]
driver = messagingv2
